{
  "name": "design-viewer",
  "version": "0.0.1",
  "main": "app/main.js",
  "scripts": {
    "dev:storage": "tsx src/storage-subscriber.ts --env=development",
    "dev:upgrade": "tsx src/upgrade.ts --env=development",
    "dev:all": "concurrently -k -n storage,alert \"npm run dev:storage\" \"npm run dev:alert\"",
    "dev": "ts-node-dev -r tsconfig-paths/register ./src/main.ts --env=development | pino-pretty --colorize ",
    "start": "node app/main.js",
    "prebuild": "rimraf build/app && rimraf build/node_modules && rimraf build/temp",
    "copypackage": "cp package.json build/",
    "copyenv": "cp .env.prod build/",
    "copysql": "cp data/design-viewer.sql build/data/",
    "copy:better-sqlite3": "cp ../better-sqlite3/better_sqlite3.node build/node_modules/better-sqlite3/build/Release",
    "build:server": "tsc -p tsconfig.json && tsc-alias -p tsconfig.json",
    "build:webapp": "cd ../webapp-vue && npm run build",
    "build": "npm run build:server && npm run build:webapp",
    "install:prod": "cd build && npm install --production",
    "copy:all": "npm run copyenv && npm run copypackage && npm run copysql",
    "压缩build文件夹（作为升级包使用，不包含node_modeuls,www下部分文件夹，如tiles,pdfjs）": "",
    "pack:upgrade": "tar -zcvf ../upgrade/src/build.tar.gz -C . build/app build/.env.prod build/package.json build/www/index.html build/www/favicon.ico build/www/assets",
    "选择复制build文件夹": "",
    "copy:build": "node scripts/copy-build.js",
    "完整复制build文件夹": "",
    "copy:build:full": "node scripts/copy-build.js full",
    "精简压缩module": "",
    "optimize:modules": "cd build &&modclean --run --patterns='default:safe'",
    "清除modules": "",
    "optimize:cleanup": "node scripts/cleanup-modules.js",
    "JS源码混淆器与压缩": "",
    "optimize:backend": "node scripts/terser-optimize.js",
    "压缩node_modules": "",
    "optimize:node_modules": "node scripts/compress-node-modules.js",
    "模拟主控服务": "",
    "test:master": "node test/master-sim.js",
    "clean:bin": "rm -rf build/node_modules/.bin && rm -f build/package-lock.json && rm -f build/tsconfig.tsbuildinfo",
    "完整构建流程": "第一次执行，在运行npm run  build 之后执行，安装依赖，复制编译后的sqlite依赖，使用Ubuntu 或其他Linux 环境执行",
    "build:complete": "npm run copy:all && npm run install:prod && npm run optimize:modules && npm run optimize:cleanup && npm run clean:bin && npm run copy:better-sqlite3 && npm run copy:build:full",
    "后续升级构建": "没有更新依赖包的情况（代码升级），win10 或Ubuntu环境",
    "build:upgrade": "npm run copy:all && npm run optimize:backend && npm run pack:upgrade",
    "默认升级构建": "",
    "postbuild": "npm run build:upgrade && npm run copy:build"
  },
  "keywords": [],
  "author": "zhangjing",
  "license": "ISC",
  "description": "",
  "dependencies": {
    "@fastify/compress": "^8.0.3",
    "@fastify/formbody": "^8.0.2",
    "@fastify/jwt": "^9.1.0",
    "@fastify/multipart": "^9.0.3",
    "@fastify/static": "^8.1.1",
    "@fastify/websocket": "^11.1.0",
    "better-sqlite3": "^11.10.0",
    "dotenv": "^16.4.7",
    "fastify": "^5.3.3",
    "fs-extra": "^11.3.0",
    "redis": "^5.5.6",
    "sm-crypto": "^0.3.13",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/better-sqlite3": "^7.6.12",
    "@types/node": "^16.18.59",
    "@types/redis": "^4.0.10",
    "@types/ws": "^8.5.14",
    "concurrently": "^9.1.2",
    "copyfiles": "^2.4.1",
    "glob": "^7.2.3",
    "modclean": "^3.0.0-beta.1",
    "pino-pretty": "^13.0.0",
    "rimraf": "^5.0.10",
    "terser": "^5.39.0",
    "ts-node": "^10.9.2",
    "ts-node-dev": "^1.1.8",
    "tsc-alias": "^1.8.11",
    "tsconfig-paths": "^4.2.0",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
